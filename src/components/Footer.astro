---
import Container from "@components/Container.astro";
import Typewriter from "@components/Typewriter.astro";
import { SITE, SOCIALS } from "@consts";
import { site, footer, footerMessages, paletteColorCount } from "@i18n/en";
import { Icon } from "astro-icon/components";
import { Code, Mail } from "@lucide/astro";

// Commit SHA display
const COMMIT_SHA_LENGTH: number = 7;
const commitSha: string = import.meta.env.COMMIT_SHA || "";
const sourceUrl: string = commitSha
  ? `https://github.com/tskovlund/skovlund.dev/commit/${commitSha}`
  : site.sourceUrl;
const sourceLabel: string = commitSha
  ? commitSha.slice(0, COMMIT_SHA_LENGTH)
  : footer.sourceLabel;

// Typewriter timing constants for footer messages
const FOOTER_TYPEWRITER_TYPE_SPEED_MS: number = 40;
const FOOTER_TYPEWRITER_DELETE_SPEED_MS: number = 25;
const FOOTER_TYPEWRITER_PAUSE_BEFORE_DELETE_MS: number = 4300;
const FOOTER_TYPEWRITER_PAUSE_AFTER_DELETE_MS: number = 200;
---

<footer class="animate">
  <Container>
    <div class="flex flex-col gap-3">
      <ul class="flex flex-wrap justify-center gap-2 font-mono">
        {
          SOCIALS.map((social) => (
            <li>
              <a
                href={social.HREF}
                target="_blank"
                rel="noopener noreferrer"
                aria-label={`${SITE.NAME} on ${social.NAME}`}
                class="group flex items-center gap-1.5 px-2.5 py-1 rounded-lg border border-tn-light-surface/40 dark:border-tn-dark-surface/40 hover:border-tn-light-surface dark:hover:border-tn-dark-surface hover:bg-tn-light-surface/30 dark:hover:bg-tn-dark-surface/30 text-xs transition-all duration-300"
              >
                <Icon
                  name={social.ICON}
                  size={14}
                  class="fill-current opacity-50 group-hover:opacity-100 transition-all duration-300"
                />
                {social.NAME}
              </a>
            </li>
          ))
        }
        <li>
          <a
            href={`mailto:${SITE.EMAIL}`}
            aria-label={`Email ${SITE.NAME}`}
            class="group flex items-center gap-1.5 px-2.5 py-1 rounded-lg border border-tn-light-surface/40 dark:border-tn-dark-surface/40 hover:border-tn-light-surface dark:hover:border-tn-dark-surface hover:bg-tn-light-surface/30 dark:hover:bg-tn-dark-surface/30 text-xs font-mono transition-all duration-300"
          >
            <Mail
              size={14}
              class="opacity-50 group-hover:opacity-100 transition-all duration-300"
            />
            Email
          </a>
        </li>
      </ul>
      <hr class="border-tn-light-surface/40 dark:border-tn-dark-surface/40" />
      <div class="flex justify-between items-center">
        <div
          class="flex gap-1.5 items-center text-tn-light-fg-muted dark:text-tn-dark-fg-muted"
        >
          &copy; <span id="footer-year">{new Date().getFullYear()}</span>
          {SITE.NAME}
        </div>
        <a
          href={sourceUrl}
          target="_blank"
          rel="noopener noreferrer"
          class="flex items-center gap-1.5 text-sm opacity-60 hover:opacity-100 hover:text-tn-light-accent dark:hover:text-tn-dark-accent transition-all duration-300"
        >
          <Code size={14} />
          {sourceLabel}
        </a>
      </div>
      <hr class="border-tn-light-surface/40 dark:border-tn-dark-surface/40" />
      <div
        class="text-xs italic text-center sm:whitespace-nowrap sm:overflow-visible"
      >
        <Typewriter
          id="footer-message"
          texts={footerMessages}
          mode="shuffle"
          paletteColorCount={paletteColorCount}
          typeSpeedMs={FOOTER_TYPEWRITER_TYPE_SPEED_MS}
          deleteSpeedMs={FOOTER_TYPEWRITER_DELETE_SPEED_MS}
          pauseBeforeDeleteMs={FOOTER_TYPEWRITER_PAUSE_BEFORE_DELETE_MS}
          pauseAfterDeleteMs={FOOTER_TYPEWRITER_PAUSE_AFTER_DELETE_MS}
        />
      </div>
    </div>
  </Container>
</footer>
