---
import Container from "@components/Container.astro";
import Link from "@components/Link.astro";
import { Sun, Moon, Monitor, Menu, X } from "@lucide/astro";
import { site, nav } from "@i18n/en";
---

<header>
  <Container>
    <div class="flex justify-between items-center font-mono">
      <a
        href="/"
        id="nav-home"
        class="font-semibold text-tn-light-accent dark:text-tn-dark-accent hover:text-tn-light-accent-hover dark:hover:text-tn-dark-accent-hover transition-colors duration-300"
      >
        {site.brandName}
      </a>

      <!-- Desktop nav + theme -->
      <div class="hidden sm:flex items-center gap-3">
        <nav class="flex gap-1.5 text-base">
          <Link href="/about" underline={false}>{nav.about.label}</Link>
          <span class="text-tn-light-fg-muted/30 dark:text-tn-dark-fg-muted/30"
            >/</span
          >
          <Link href="/blog" underline={false}>{nav.blog.label}</Link>
          <span class="text-tn-light-fg-muted/30 dark:text-tn-dark-fg-muted/30"
            >/</span
          >
          <Link href="/projects" underline={false}>{nav.projects.label}</Link>
          <span class="text-tn-light-fg-muted/30 dark:text-tn-dark-fg-muted/30"
            >/</span
          >
          <Link href="/shelf" underline={false}>{nav.shelf.label}</Link>
        </nav>
        <div
          class="flex items-center gap-0.5 ml-1 border-l border-tn-light-surface dark:border-tn-dark-surface pl-3"
        >
          <button
            data-theme-button="light"
            aria-label="Light theme"
            aria-pressed="false"
            class="group size-7 flex items-center justify-center rounded-full hover:bg-tn-light-surface/50 dark:hover:bg-tn-dark-surface/50 transition-colors duration-300"
          >
            <Sun
              size={15}
              class="stroke-current group-hover:stroke-tn-light-fg group-hover:dark:stroke-tn-dark-fg transition-colors duration-300"
            />
          </button>
          <button
            data-theme-button="dark"
            aria-label="Dark theme"
            aria-pressed="false"
            class="group size-7 flex items-center justify-center rounded-full hover:bg-tn-light-surface/50 dark:hover:bg-tn-dark-surface/50 transition-colors duration-300"
          >
            <Moon
              size={15}
              class="stroke-current group-hover:stroke-tn-light-fg group-hover:dark:stroke-tn-dark-fg transition-colors duration-300"
            />
          </button>
          <button
            data-theme-button="system"
            aria-label="System theme"
            aria-pressed="false"
            class="group size-7 flex items-center justify-center rounded-full hover:bg-tn-light-surface/50 dark:hover:bg-tn-dark-surface/50 transition-colors duration-300"
          >
            <Monitor
              size={15}
              class="stroke-current group-hover:stroke-tn-light-fg group-hover:dark:stroke-tn-dark-fg transition-colors duration-300"
            />
          </button>
        </div>
      </div>

      <!-- Mobile hamburger -->
      <button
        id="menu-toggle"
        class="sm:hidden size-9 flex items-center justify-center rounded-full hover:bg-tn-light-surface/50 dark:hover:bg-tn-dark-surface/50 transition-colors duration-300"
        aria-label="Toggle navigation menu"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <Menu
          size={20}
          id="menu-open-icon"
          class="stroke-current"
          aria-hidden="true"
        />
        <X
          size={20}
          id="menu-close-icon"
          class="stroke-current hidden"
          aria-hidden="true"
        />
      </button>
    </div>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden sm:hidden pt-4 pb-2 font-mono">
      <nav class="flex flex-col gap-3 text-base">
        {
          Object.entries(nav).map(([key, navItem]) => {
            const subtitleId: string = `nav-${key}-subtitle`;
            return (
              <div>
                <Link
                  href={`/${key}`}
                  underline={false}
                  aria-describedby={navItem.subtitle ? subtitleId : undefined}
                >
                  {navItem.label}
                </Link>
                {navItem.subtitle && (
                  <p
                    id={subtitleId}
                    class="text-xs text-tn-light-fg-muted dark:text-tn-dark-fg-muted mt-0.5"
                  >
                    {navItem.subtitle}
                  </p>
                )}
              </div>
            );
          })
        }
      </nav>
      <div
        class="flex items-center gap-1 mt-4 pt-3 border-t border-tn-light-surface/30 dark:border-tn-dark-surface/30"
      >
        <button
          data-theme-button="light"
          aria-label="Light theme"
          class="group size-8 flex items-center justify-center rounded-full hover:bg-tn-light-surface/50 dark:hover:bg-tn-dark-surface/50 transition-colors duration-300"
        >
          <Sun
            size={16}
            class="stroke-current group-hover:stroke-tn-light-fg group-hover:dark:stroke-tn-dark-fg transition-colors duration-300"
          />
        </button>
        <button
          data-theme-button="dark"
          aria-label="Dark theme"
          class="group size-8 flex items-center justify-center rounded-full hover:bg-tn-light-surface/50 dark:hover:bg-tn-dark-surface/50 transition-colors duration-300"
        >
          <Moon
            size={16}
            class="stroke-current group-hover:stroke-tn-light-fg group-hover:dark:stroke-tn-dark-fg transition-colors duration-300"
          />
        </button>
        <button
          data-theme-button="system"
          aria-label="System theme"
          class="group size-8 flex items-center justify-center rounded-full hover:bg-tn-light-surface/50 dark:hover:bg-tn-dark-surface/50 transition-colors duration-300"
        >
          <Monitor
            size={16}
            class="stroke-current group-hover:stroke-tn-light-fg group-hover:dark:stroke-tn-dark-fg transition-colors duration-300"
          />
        </button>
      </div>
    </div>
  </Container>

  <!-- Hover tagline for nav links (desktop only, positioned via JS) -->
  <p
    id="nav-tagline"
    class="hidden absolute left-0 bottom-0 translate-y-full text-xs text-tn-light-fg-muted/60 dark:text-tn-dark-fg-muted/60 font-mono py-1 whitespace-nowrap pointer-events-none transition-opacity duration-150"
  >
  </p>
</header>
